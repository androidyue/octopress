---
layout: post
title: "树莓派修改 DNS 服务器配置"
date: 2020-05-01 14:18
comments: true
categories: 树莓派 Dns Raspbian Linux RaspberryPi
---

## 修改配置文件
```bash
sudo vim /etc/dhcpcd.conf
```

增加如下内容，我们使用Google DNS（北京联通测试速度不错）
```bash
static domain_name_servers=8.8.8.8 8.8.4.4
```
<!--more-->
完整的示例文件部分
```bash
interface eth0
        static ip_address=192.168.1.3/24
        static routers=192.168.1.1
        static domain_name_servers=8.8.8.8 8.8.4.4
```

## 设置配置生效
```bash
sudo service dhcpcd restart
```

## 验证是否生效
我们使用dig命令验证dns是否生效
```bash
dig droidyue.com

; <<>> DiG 9.11.5-P4-5.1-Raspbian <<>> droidyue.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 54841
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;droidyue.com.			IN	A

;; ANSWER SECTION:
droidyue.com.		299	IN	A	104.27.129.205
droidyue.com.		299	IN	A	104.27.128.205

;; Query time: 44 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
;; WHEN: Sun Apr 19 17:07:11 CST 2020
;; MSG SIZE  rcvd: 73
```

重点看这个信息

```bash
;; Query time: 44 msec
;; SERVER: 8.8.8.8#53(8.8.8.8)
;; WHEN: Sun Apr 19 17:07:11 CST 2020
;; MSG SIZE  rcvd: 73
```

## 注意
不要直接修改这个文件`/etc/resolv.conf`
```bash
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 8.8.8.8
nameserver fe80::1%eth0
You have new mail in /var/mail/pi
```

正如上面英文说得，这个文件会被冲掉，未来某个时间你还需要重新设置。所以按照文章中的修改即可。

## 推荐阅读
  * [树莓派入手指南](https://droidyue.com/blog/2016/08/22/before-you-buy-raspberry-pi/)
  * [树莓派安装jdk 8](https://droidyue.com/blog/2020/02/23/install-jdk-on-raspberry-pi/)
  * [树莓派 Gitlab问题整理](https://droidyue.com/blog/2020/03/29/install-gitlab-on-raspberry-pi-issues/)
  * [修复ssh 首次登录树莓派失败的问题](https://droidyue.com/blog/2020/03/29/ssh-raspberrypi-failure/)
